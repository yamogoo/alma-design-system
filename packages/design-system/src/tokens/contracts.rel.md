# Relational Color System — Usage Manifest (v1)

_Last updated: 2025-10-03_

## 0) Scope & Goal

This document defines how to **use** the relational color system in products, components, and tokens. It turns the relational color matrix into enforceable rules so that UI remains consistent, accessible, and easy to theme.

- **Single source of truth:** `contracts/rel/*` (the relational matrix).
- \*\*Consumers: component tokens.
- **Outcome:** predictable color behavior, automatic state generation, and self-documenting rules.

---

## 1) Vocabulary

**Roles** (extensible): `Neutral | Accent | Positive | Negative | Warning`

**Planes:**

- `Surface` — container/backgrounds.
- `Stroke` — borders/lines/outlines.
- `OnSurface` — graphics/icons placed on a surface (contextual).
- `Label` — text/labels (generic / more detached from specific surfaces).
- `Border` — convenience alias derived from `Stroke` for component borders/dividers.

**Tones (ladder):** `xxl-lighter, xl-lighter, lighter, base, darker, xl-darker, xxl-darker`
(Alternatively use numeric steps; the ladder must be **monotonic**.)

**States:** `idle, hover, pressed, focus, disabled` (state values are **derived** via deltas).

---

## 2) Core Principles

1. **Matrix is law.** Components may only reference colors through the relational matrix.
2. **No cross-facet mixing.** A component cannot mix planes/roles arbitrarily. Every property must pull from its **assigned plane** and **current role**.
3. **Deterministic states.** States (`hover/pressed/disabled/focus`) are generated by formulas/deltas — not manually curated per token.
4. **Contrast first.** Foreground choices (Label/OnSurface) must satisfy WCAG contrast thresholds against their background.
5. **Semantics over hex.** Semantic and component tokens reference matrix entries; raw hex appears **only** in base palettes.

---

## 3) Contracts: Allowed Sources per Component Property

For each component property use **only** the sources listed below. Do not reference other planes/roles.

| Property     | Allowed source (path pattern)                                                                                                                                            |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `background` | `contracts/rel/surface/<role>/<tone>/<state>`                                                                                                                            |
| `border`     | `contracts/rel/stroke/<role>/<tone>/<state>` _(or `border` alias)_                                                                                                       |
| `foreground` | Prefer `contracts/rel/label/<role>/<tone>/<state>`; alternatively `contracts/rel/onSurface/<role>/<tone>/<state>` when typography is not used. Must pass contrast rules. |
| `outline`    | `contracts/rel/stroke/<role>/base/focus` or theme-specific focus ring token derived from `Stroke`.                                                                       |
| `overlay`    | `contracts/rel/surface/<role>/<tone>/<state>` with alpha per overlay rules.                                                                                              |

**Role coupling:** The role chosen by the component (e.g., `Accent.Primary`) applies **uniformly** to background/border/foreground sources. Roles must not be mixed inside a single visual entity.

---

## 4) Naming & Paths

**Relational matrix:**

```
contracts/rel/<plane>/<role>/<tone>/<state>
```

**Component tokens map** to `contracts/rel/*` and expose domain semantics:

```
components/button/accent/primary/background -> contracts/rel/surface/accent/lighter/idle
components/button/accent/primary/label      -> contracts/rel/label/accent/base/idle
```

**Component tokens** reference semantic tokens only — not raw relational paths.

---

## 5) Contrast Requirements (WCAG)

- **Text (normal):** ≥ 4.5:1 against background.
- **Text (≥ 18px regular or ≥ 14px bold):** ≥ 3.0:1.
- **Non-text UI (icons/graphics essential to understanding):** ≥ 3.0:1 recommended.
- When a chosen `Label/OnSurface` tone fails min contrast, select the nearest tone within the **same role** that passes. If none pass, use the role’s **inverse** label (as defined by the theme) and log an override.

**Recommended color space for deltas:** perceptual (e.g., OKLCH/OKLab). Avoid HSL/HSV for accessibility-sensitive deltas.

---

## 6) State Generation Rules (Deltas)

State values are computed from the base tone by applying **theme rules**. Example defaults (tune per theme):

```
hover:   ΔL +0.03 (light theme) / ΔL -0.03 (dark theme)
pressed: ΔL -0.04 (light theme) / ΔL +0.04 (dark theme)
disabled: α -0.50, ΔC -0.20, enforce min contrast with disabled text color
focus:   use stroke focus ring derived from role’s Stroke base (optionally +ΔC)
```

All states must be \*\*dete
